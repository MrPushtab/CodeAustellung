The Renderer code, while somewhat significantly altered for my purposes, is not originally mine.
