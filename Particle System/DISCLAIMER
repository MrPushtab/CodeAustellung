The Renderer code has been significantly altered for my purposes, but is not solely my own.
